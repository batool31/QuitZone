<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QuitZone - Chatbot</title>
  <link rel="stylesheet" href="grad.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- AOS Animation Library -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <!-- Axios for API calls -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <!-- Header -->
  <header class="navbar">
    <div class="container">
      <a href="home.html" class="logo">
        <span>QuitZone</span>
        <span class="emoji">üö≠</span>
      </a>
      
      <!-- Mobile menu button -->
      <button class="mobile-menu-btn" aria-label="Toggle menu">
        <i class="fas fa-bars"></i>
      </button>
      
      <!-- Navigation Links for Desktop -->
      <nav class="nav-desktop">
        <ul>
          <li><a href="home.html" class="nav-link">Home</a></li>
          <li><a href="progress.html" class="nav-link">Progress</a></li>
          <li><a href="challenges.html" class="nav-link">Challenges</a></li>
          <li><a href="savings.html" class="nav-link">Savings</a></li>
          <li><a href="success_stories.html" class="nav-link">Success Stories</a></li>
          <li><a href="chatbot.html" class="nav-link active">Chatbot</a></li>
          <li><a href="login.php" class="login-btn">Login</a></li>
        </ul>
      </nav>
    </div>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu">
      <ul>
        <li><a href="home.html">Home</a></li>
        <li><a href="progress.html">Progress</a></li>
        <li><a href="challenges.html">Challenges</a></li>
        <li><a href="savings.html">Savings</a></li>
        <li><a href="success_stories.html">Success Stories</a></li>
        <li><a href="chatbot.html">Chatbot</a></li>
        <li><a href="login.php" class="mobile-login-btn">Login</a></li>
      </ul>
    </div>
    
    <!-- Menu Overlay -->
    <div class="menu-overlay"></div>
  </header>

  <main class="container chatbot-container">
    <div class="chatbot-header" data-aos="fade-up">
      <h1>QuitBot - Your Quitting Assistant</h1>
      <p>Get support, advice, and motivation any time you need it. I'm here to help you on your smoke-free journey!</p>
    </div>
    
    <div class="chatbot-wrapper" data-aos="fade-up" data-aos-delay="200">
      <div class="chat-sidebar">
        <div class="sidebar-header">
          <h3><i class="fas fa-robot"></i> QuitBot</h3>
          <span class="status-indicator online"></span>
        </div>
        
        <div class="quick-actions">
          <h4>Quick Actions</h4>
          <div class="quick-buttons">
            <button onclick="sendQuickQuestion('Help with cravings')">
              <i class="fas fa-fire-alt"></i> Help with cravings
            </button>
            <button onclick="sendQuickQuestion('Withdrawal symptoms')">
              <i class="fas fa-head-side-cough"></i> Withdrawal symptoms
            </button>
            <button onclick="sendQuickQuestion('Benefits of quitting')">
              <i class="fas fa-heartbeat"></i> Benefits of quitting
            </button>
            <button onclick="sendQuickQuestion('Quitting tips')">
              <i class="fas fa-lightbulb"></i> Quitting tips
            </button>
            <button onclick="sendQuickQuestion('Health improvements timeline')">
              <i class="fas fa-clock"></i> Health improvements
            </button>
          </div>
        </div>
        
        <div class="conversation-stats">
          <div class="stat-item">
            <span class="stat-label">Messages Sent</span>
            <span class="stat-value" id="messages-count">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Today's Streak</span>
            <span class="stat-value" id="today-streak">0</span>
          </div>
        </div>
      </div>
      
      <div class="chat-main">
        <div id="chat-box" class="chat-box">
          <div class="chat-date">Today</div>
          <div class="chat-message bot">
            <div class="message-avatar">
              <i class="fas fa-robot"></i>
            </div>
            <div class="message-content">
              <p>üëã Hello! I'm QuitBot, your personal assistant on your journey to quit smoking. How can I help you today?</p>
            </div>
            <div class="message-time">Just now</div>
          </div>
          
          <div class="chat-message bot">
            <div class="message-avatar">
              <i class="fas fa-robot"></i>
            </div>
            <div class="message-content">
              <p>You can ask me about:</p>
              <ul>
                <li>Dealing with withdrawal symptoms</li>
                <li>Tips for handling cravings</li>
                <li>Benefits of quitting smoking</li>
                <li>Health improvements timeline</li>
                <li>Strategies for staying smoke-free</li>
              </ul>
              <p>What's on your mind?</p>
            </div>
            <div class="message-time">Just now</div>
          </div>
        </div>
        
        <div class="chat-input-container">
          <div class="input-wrapper">
            <input 
              type="text" 
              id="user-input" 
              placeholder="Type your message here..." 
              onkeypress="handleKeyPress(event)"
            />
            <button class="emoji-btn" onclick="toggleEmojiPicker()">
              <i class="far fa-smile"></i>
            </button>
          </div>
          
          <button class="send-btn" onclick="sendMessage()">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
        
        <div class="emoji-picker" id="emoji-picker">
          <div class="emoji-categories">
            <button class="category-btn active" data-category="smileys">üòä</button>
            <button class="category-btn" data-category="gestures">üëç</button>
            <button class="category-btn" data-category="food">üçé</button>
            <button class="category-btn" data-category="travel">üöó</button>
            <button class="category-btn" data-category="objects">‚åö</button>
          </div>
          <div class="emoji-grid" id="emoji-grid">
            <!-- Emojis will be populated here -->
          </div>
        </div>
      </div>
    </div>
    
    <div class="chatbot-features" data-aos="fade-up" data-aos-delay="300">
      <div class="feature-card">
        <div class="feature-icon">
          <i class="fas fa-clock"></i>
        </div>
        <h3>24/7 Support</h3>
        <p>QuitBot is always here for you, whenever you need support or advice.</p>
      </div>
      
      <div class="feature-card">
        <div class="feature-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <h3>Privacy First</h3>
        <p>Your conversations are private and secure. We respect your confidentiality.</p>
      </div>
      
      <div class="feature-card">
        <div class="feature-icon">
          <i class="fas fa-brain"></i>
        </div>
        <h3>AI-Powered</h3>
        <p>Powered by advanced AI to provide personalized advice and support.</p>
      </div>
    </div>
    
    <div class="chat-topics" data-aos="fade-up" data-aos-delay="400">
      <h2>Popular Conversation Topics</h2>
      <div class="topics-grid">
        <div class="topic-card" onclick="sendQuickQuestion('How to deal with morning cravings?')">
          <div class="topic-icon">
            <i class="fas fa-sun"></i>
          </div>
          <h3>Morning Cravings</h3>
          <p>Strategies to manage those tough morning urges.</p>
        </div>
        
        <div class="topic-card" onclick="sendQuickQuestion('How to deal with stress without smoking?')">
          <div class="topic-icon">
            <i class="fas fa-brain"></i>
          </div>
          <h3>Stress Management</h3>
          <p>Handling stress without reaching for a cigarette.</p>
        </div>
        
        <div class="topic-card" onclick="sendQuickQuestion('What changes happen in my body after quitting?')">
          <div class="topic-icon">
            <i class="fas fa-heartbeat"></i>
          </div>
          <h3>Body Recovery</h3>
          <p>How your body heals after quitting smoking.</p>
        </div>
        
        <div class="topic-card" onclick="sendQuickQuestion('Social situations and smoking')">
          <div class="topic-icon">
            <i class="fas fa-users"></i>
          </div>
          <h3>Social Situations</h3>
          <p>Navigating social events without smoking.</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <svg class="footer-wave" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
      <path fill="#ffe1e1" fill-opacity="1" d="M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,202.7C672,203,768,181,864,181.3C960,181,1056,203,1152,208C1248,213,1344,203,1392,197.3L1440,192L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
    </svg>
    <div class="container">
      <div class="footer-content">
        <div class="footer-logo">
          <a href="home.html">
            <span>QuitZone</span>
            <span class="emoji">üö≠</span>
          </a>
        </div>
        
        <div class="social-links">
          <a href="https://facebook.com" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-facebook-f"></i>
          </a>
          <a href="https://instagram.com" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-instagram"></i>
          </a>
          <a href="https://twitter.com" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-twitter"></i>
          </a>
        </div>
        
        <div class="footer-nav">
          <a href="home.html">Home</a>
          <a href="progress.html">Progress</a>
          <a href="challenges.html">Challenges</a>
          <a href="savings.html">Savings</a>
          <a href="success_stories.html">Success Stories</a>
          <a href="chatbot.html">Chatbot</a>
        </div>
        
        <div class="copyright">
          <p>¬© 2025 QuitZone - All Rights Reserved</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Modal for typing indicator and connection issues -->
  <div class="connection-alert" id="connection-alert">
    <div class="alert-icon">
      <i class="fas fa-exclamation-triangle"></i>
    </div>
    <div class="alert-content">
      <p>Connection issue with the chatbot. Please check your internet connection and try again.</p>
    </div>
    <button class="alert-close" onclick="closeConnectionAlert()">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <!-- AOS Animation Library -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  
  <script>
    // Initialize AOS animation library
    AOS.init({
      duration: 800,
      easing: 'ease-in-out',
      once: true
    });
    
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
      const mobileMenu = document.querySelector('.mobile-menu');
      const menuOverlay = document.querySelector('.menu-overlay');
      
      if (mobileMenuBtn && mobileMenu && menuOverlay) {
        mobileMenuBtn.addEventListener('click', function() {
          mobileMenu.classList.toggle('open');
          menuOverlay.classList.toggle('open');
          
          const icon = mobileMenuBtn.querySelector('i');
          if (icon) {
            if (icon.classList.contains('fa-bars')) {
              icon.classList.remove('fa-bars');
              icon.classList.add('fa-times');
            } else {
              icon.classList.remove('fa-times');
              icon.classList.add('fa-bars');
            }
          }
        });
        
        menuOverlay.addEventListener('click', function() {
          mobileMenu.classList.remove('open');
          menuOverlay.classList.remove('open');
          
          const icon = mobileMenuBtn.querySelector('i');
          if (icon) {
            icon.classList.remove('fa-times');
            icon.classList.add('fa-bars');
          }
        });
      }
      
      // Navbar scroll effect
      const navbar = document.querySelector('.navbar');
      window.addEventListener('scroll', function() {
        if (window.scrollY > 50) {
          navbar.classList.add('scrolled');
        } else {
          navbar.classList.remove('scrolled');
        }
      });
      
      // Initialize emoji picker
      initializeEmojiPicker();
      
      // Focus on input field
      document.getElementById('user-input').focus();
      
      // Get message count from localStorage
      const messageCount = localStorage.getItem('messageCount') || 0;
      document.getElementById('messages-count').textContent = messageCount;
      
      // Set today's streak
      const todayStreak = localStorage.getItem('todayStreak') || 0;
      document.getElementById('today-streak').textContent = todayStreak;
    });
    
    // Handle Enter key press in input field
    function handleKeyPress(event) {
      if (event.key === 'Enter') {
        sendMessage();
      }
    }
    
    // Send message
    function sendMessage() {
      const userInput = document.getElementById('user-input');
      const userMessage = userInput.value.trim();
      
      if (!userMessage) return;
      
      // Add user message to chat
      appendMessage('user', userMessage);
      
      // Clear input field
      userInput.value = '';
      
      // Increment message count
      updateMessageCount();
      
      // Show typing indicator
      showTypingIndicator();
      
      // Use OpenAI API to get response
      getBotResponse(userMessage);
    }
    
    // Send quick question
    function sendQuickQuestion(question) {
      document.getElementById('user-input').value = question;
      sendMessage();
    }
    
    // Append message to chat
    function appendMessage(sender, message, delay = 0) {
      setTimeout(() => {
        const chatBox = document.getElementById('chat-box');
        const messageElement = document.createElement('div');
        messageElement.className = `chat-message ${sender}`;
        
        const currentTime = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        
        let avatar = '';
        if (sender === 'user') {
          avatar = '<div class="message-avatar"><i class="fas fa-user"></i></div>';
        } else {
          avatar = '<div class="message-avatar"><i class="fas fa-robot"></i></div>';
        }
        
        messageElement.innerHTML = `
          ${avatar}
          <div class="message-content">
            <p>${formatMessage(message)}</p>
          </div>
          <div class="message-time">${currentTime}</div>
        `;
        
        chatBox.appendChild(messageElement);
        
        // Auto scroll to bottom
        chatBox.scrollTop = chatBox.scrollHeight;
        
        // Add animation class
        setTimeout(() => {
          messageElement.classList.add('show');
        }, 10);
      }, delay);
    }
    
    // Format message with links and line breaks
    function formatMessage(message) {
      // Convert URLs to hyperlinks
      const urlRegex = /(https?:\/\/[^\s]+)/g;
      message = message.replace(urlRegex, (url) => {
        return `<a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a>`;
      });
      
      // Convert line breaks to <br>
      message = message.replace(/\n/g, '<br>');
      
      return message;
    }
    
    // Show typing indicator
    function showTypingIndicator() {
      const chatBox = document.getElementById('chat-box');
      const indicator = document.createElement('div');
      indicator.className = 'chat-message bot typing-indicator';
      indicator.id = 'typing-indicator';
      
      indicator.innerHTML = `
        <div class="message-avatar">
          <i class="fas fa-robot"></i>
        </div>
        <div class="message-content">
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      `;
      
      chatBox.appendChild(indicator);
      chatBox.scrollTop = chatBox.scrollHeight;
    }
    
    // Hide typing indicator
    function hideTypingIndicator() {
      const indicator = document.getElementById('typing-indicator');
      if (indicator) {
        indicator.remove();
      }
    }
    
    // Get bot response
    function getBotResponse(userMessage) {
      const API_KEY = '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';

      // Simulate typing delay
      setTimeout(() => {
        // This is a placeholder for the actual API call
        // In a real implementation, this would be a call to the OpenAI API
        
        // Using mockBotResponse for demonstration
        mockBotResponse(userMessage);
        
        // Comment out the code below when using mockBotResponse
        /*
        try {
          axios.post('https://api.openai.com/v1/chat/completions', {
            model: "gpt-3.5-turbo",
            messages: [
              { 
                role: "system", 
                content: "You are QuitBot, a helpful assistant for people trying to quit smoking. Provide supportive, informative responses about quitting smoking, health benefits, coping strategies, and motivation. Keep responses concise (3-4 sentences max)."
              },
              { role: "user", content: userMessage }
            ]
          }, {
            headers: {
              'Authorization': `Bearer ${API_KEY}`,
              'Content-Type': 'application/json',
            }
          })
          .then(response => {
            hideTypingIndicator();
            const botMessage = response.data.choices[0].message.content;
            appendMessage('bot', botMessage);
            updateTodayStreak();
          })
          .catch(error => {
            console.error("Error communicating with OpenAI:", error);
            hideTypingIndicator();
            showConnectionAlert();
            appendMessage('bot', "I'm sorry, I'm having trouble connecting right now. Please try again later.");
          });
        } catch (error) {
          console.error("Error in API call setup:", error);
          hideTypingIndicator();
          showConnectionAlert();
          appendMessage('bot', "I'm sorry, I'm having trouble connecting right now. Please try again later.");
        }
        */
      }, 1500);
    }
    
    // Mock bot response for demonstration
    function mockBotResponse(userMessage) {
      hideTypingIndicator();
      
      // Convert user message to lowercase for easier matching
      const messageLower = userMessage.toLowerCase();
      
      let response = '';
      
      // Basic pattern matching for common questions
      if (messageLower.includes('hello') || messageLower.includes('hi')) {
        response = "Hi there! üëã I'm here to support you on your quit smoking journey. How can I help you today?";
      } 
      else if (messageLower.includes('craving') || messageLower.includes('urge')) {
        response = "Cravings typically last 3-5 minutes. Try the 4Ds: Deep breaths, Drink water, Distract yourself, and Delay acting on the urge. Physical activity can also help redirect your focus and reduce cravings intensity.";
      } 
      else if (messageLower.includes('withdrawal') || messageLower.includes('symptoms')) {
        response = "Common withdrawal symptoms include irritability, anxiety, difficulty concentrating, increased appetite, and sleep disturbances. These symptoms are temporary and usually peak within the first week and gradually decrease over 2-4 weeks. Stay hydrated and maintain a balanced diet to help manage them.";
      } 
      else if (messageLower.includes('benefit') || messageLower.includes('health')) {
        response = "Within 20 minutes of quitting, your heart rate drops. Within 24 hours, carbon monoxide levels normalize. After 2 weeks, lung function and circulation improve. After 1 year, your risk of heart disease drops by half. After 5 years, many cancer risks are reduced significantly.";
      } 
      else if (messageLower.includes('tips') || messageLower.includes('advice')) {
        response = "Here are some top quitting tips: 1) Identify your triggers and plan alternatives, 2) Stay hydrated and maintain a balanced diet, 3) Exercise regularly to manage stress, 4) Use relaxation techniques like deep breathing, 5) Celebrate small victories along the way!";
      } 
      else if (messageLower.includes('stress') || messageLower.includes('anxiety')) {
        response = "Try deep breathing: inhale for 4 counts, hold for 2, exhale for 6. Physical exercise releases endorphins that reduce stress naturally. Progressive muscle relaxation can also help‚Äîtense and release muscle groups from head to toe. Remember, stress is temporary, but quitting benefits are lifelong.";
      } 
      else if (messageLower.includes('sleep') || messageLower.includes('insomnia')) {
        response = "Sleep disturbances are common when quitting smoking. Establish a calming bedtime routine, avoid screens an hour before bed, try a warm bath or shower, and keep your bedroom cool and dark. Avoid caffeine after noon, and try relaxation techniques like gentle stretching or meditation.";
      } 
      else if (messageLower.includes('weight') || messageLower.includes('eating')) {
        response = "Some weight gain is normal when quitting smoking due to increased appetite and metabolic changes. Focus on nutrient-dense foods like fruits, vegetables, lean proteins and whole grains. Keep healthy snacks on hand and stay active. Remember, any weight gain is minor compared to the health benefits of quitting.";
      } 
      else if (messageLower.includes('morning') && messageLower.includes('craving')) {
        response = "Morning cravings can be intense as nicotine levels drop overnight. Replace your morning cigarette with a new routine: try a brisk walk, a shower, or a healthy breakfast. Drinking a glass of water or fresh juice can also help. Plan your morning activities to avoid triggers.";
      } 
      else if (messageLower.includes('social') || messageLower.includes('friends')) {
        response = "Social situations can be challenging when quitting. Let friends know you've quit so they can support you. Have a non-alcoholic drink in hand to keep busy. If needed, take short breaks from triggering situations. Remember, it's okay to temporarily avoid situations that might lead to a relapse.";
      } 
      else if (messageLower.includes('relapse') || messageLower.includes('slip')) {
        response = "A slip doesn't mean failure! Most people make several quit attempts before succeeding permanently. Learn from what triggered the slip, strengthen your plan, and keep going. Remember why you want to quit and focus on how far you've come, not on a temporary setback.";
      } 
      else if (messageLower.includes('save') || messageLower.includes('money')) {
        response = "Quitting smoking creates significant financial savings. A pack-a-day smoker saving $10 daily accumulates $3,650 yearly! Try setting up a special account for this money and watching it grow. Many people use these savings for a vacation, home improvements, or other goals they couldn't afford while smoking.";
      } 
      else if (messageLower.includes('thank') || messageLower.includes('thanks')) {
        response = "You're very welcome! I'm here anytime you need support or information. Keep up the fantastic work on your quit journey! üëç";
      } 
      else {
        response = "Thanks for reaching out. I'm here to support your quit smoking journey with information on cravings, withdrawal symptoms, health benefits, and coping strategies. Let me know if you need advice on any specific aspect of quitting smoking.";
      }
      
      appendMessage('bot', response);
      updateTodayStreak();
    }
    
    // Update message count
    function updateMessageCount() {
      const countElement = document.getElementById('messages-count');
      let count = parseInt(countElement.textContent) || 0;
      count += 1;
      countElement.textContent = count;
      
      // Store in localStorage
      localStorage.setItem('messageCount', count);
    }
    
    // Update today's streak
    function updateTodayStreak() {
      const streakElement = document.getElementById('today-streak');
      let streak = parseInt(streakElement.textContent) || 0;
      streak += 1;
      streakElement.textContent = streak;
      
      // Store in localStorage
      localStorage.setItem('todayStreak', streak);
    }
    
    // Initialize emoji picker
    function initializeEmojiPicker() {
      const emojiGrid = document.getElementById('emoji-grid');
      
      // Create emoji categories
      const emojiCategories = {
        smileys: ['üòä', 'üòÉ', 'üòÑ', 'üòÅ', 'üòÜ', 'üòÖ', 'üòÇ', 'ü§£', 'ü•≤', '‚ò∫Ô∏è', 'üòá', 'üôÇ', 'üôÉ', 'üòâ', 'üòå', 'üòç', 'ü•∞', 'üòò'],
        gestures: ['üëç', 'üëé', 'üëå', '‚úåÔ∏è', 'ü§û', 'ü§ü', 'ü§ô', 'ü§ò', 'üëä', 'üëã', 'ü§ö', 'üñêÔ∏è', '‚úã', 'üññ', 'üëè', 'üôå', 'ü§ù', 'üí™'],
        food: ['üçé', 'üçê', 'üçä', 'üçã', 'üçå', 'üçâ', 'üçá', 'üçì', 'ü´ê', 'üçà', 'üçí', 'üçë', 'ü•≠', 'üçç', 'ü••', 'ü•ù', 'üçÖ', 'ü•ë'],
        travel: ['üöó', '‚úàÔ∏è', 'üöÇ', '‚õ¥Ô∏è', 'üö¢', 'üöÅ', 'üöÄ', 'üõ∏', 'üèçÔ∏è', 'üö≤', 'üöï', 'üöô', 'üöå', 'üöé', 'üèéÔ∏è', 'üöì', 'üöë', 'üöí'],
        objects: ['‚åö', 'üì±', 'üíª', '‚å®Ô∏è', 'üñ•Ô∏è', 'üñ®Ô∏è', 'üñ±Ô∏è', 'üñ≤Ô∏è', 'üì∑', 'üì∏', 'üìπ', 'üé•', 'üìΩÔ∏è', 'üéûÔ∏è', 'üìû', '‚òéÔ∏è', 'üìü', 'üì†']
      };
      
      // Load default category
      loadEmojiCategory('smileys');
      
      // Add event listeners to category buttons
      const categoryBtns = document.querySelectorAll('.category-btn');
      categoryBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          // Update active button
          categoryBtns.forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          
          // Load emojis for the selected category
          const category = this.getAttribute('data-category');
          loadEmojiCategory(category);
        });
      });
    }
    
    // Load emoji category
    function loadEmojiCategory(category) {
      const emojiGrid = document.getElementById('emoji-grid');
      emojiGrid.innerHTML = '';
      
      const emojiCategories = {
        smileys: ['üòä', 'üòÉ', 'üòÑ', 'üòÅ', 'üòÜ', 'üòÖ', 'üòÇ', 'ü§£', 'ü•≤', '‚ò∫Ô∏è', 'üòá', 'üôÇ', 'üôÉ', 'üòâ', 'üòå', 'üòç', 'ü•∞', 'üòò'],
        gestures: ['üëç', 'üëé', 'üëå', '‚úåÔ∏è', 'ü§û', 'ü§ü', 'ü§ô', 'ü§ò', 'üëä', 'üëã', 'ü§ö', 'üñêÔ∏è', '‚úã', 'üññ', 'üëè', 'üôå', 'ü§ù', 'üí™'],
        food: ['üçé', 'üçê', 'üçä', 'üçã', 'üçå', 'üçâ', 'üçá', 'üçì', 'ü´ê', 'üçà', 'üçí', 'üçë', 'ü•≠', 'üçç', 'ü••', 'ü•ù', 'üçÖ', 'ü•ë'],
        travel: ['üöó', '‚úàÔ∏è', 'üöÇ', '‚õ¥Ô∏è', 'üö¢', 'üöÅ', 'üöÄ', 'üõ∏', 'üèçÔ∏è', 'üö≤', 'üöï', 'üöô', 'üöå', 'üöé', 'üèéÔ∏è', 'üöì', 'üöë', 'üöí'],
        objects: ['‚åö', 'üì±', 'üíª', '‚å®Ô∏è', 'üñ•Ô∏è', 'üñ®Ô∏è', 'üñ±Ô∏è', 'üñ≤Ô∏è', 'üì∑', 'üì∏', 'üìπ', 'üé•', 'üìΩÔ∏è', 'üéûÔ∏è', 'üìû', '‚òéÔ∏è', 'üìü', 'üì†']
      };
      
      const emojis = emojiCategories[category] || [];
      
      emojis.forEach(emoji => {
        const emojiButton = document.createElement('button');
        emojiButton.className = 'emoji-btn';
        emojiButton.textContent = emoji;
        emojiButton.addEventListener('click', function() {
          insertEmoji(emoji);
        });
        
        emojiGrid.appendChild(emojiButton);
      });
    }
    
    // Toggle emoji picker
    function toggleEmojiPicker() {
      const emojiPicker = document.getElementById('emoji-picker');
      emojiPicker.classList.toggle('show');
      
      // Close emoji picker when clicking outside
      if (emojiPicker.classList.contains('show')) {
        document.addEventListener('click', closeEmojiPickerOnClickOutside);
      } else {
        document.removeEventListener('click', closeEmojiPickerOnClickOutside);
      }
    }
    
    // Close emoji picker when clicking outside
    function closeEmojiPickerOnClickOutside(event) {
      const emojiPicker = document.getElementById('emoji-picker');
      const emojiBtn = document.querySelector('.emoji-btn');
      
      if (!emojiPicker.contains(event.target) && event.target !== emojiBtn) {
        emojiPicker.classList.remove('show');
        document.removeEventListener('click', closeEmojiPickerOnClickOutside);
      }
    }
    
    // Insert emoji into input field
    function insertEmoji(emoji) {
      const input = document.getElementById('user-input');
      input.value += emoji;
      input.focus();
      
      const emojiPicker = document.getElementById('emoji-picker');
      emojiPicker.classList.remove('show');
    }
    
    // Show connection alert
    function showConnectionAlert() {
      const alert = document.getElementById('connection-alert');
      alert.classList.add('show');
      
      // Auto hide after 5 seconds
      setTimeout(() => {
        alert.classList.remove('show');
      }, 5000);
    }
    
    // Close connection alert
    function closeConnectionAlert() {
      const alert = document.getElementById('connection-alert');
      alert.classList.remove('show');
    }
  </script>
  
  <style>
    /* Additional Styles for Chatbot Page */
    .chatbot-container {
      padding: 7rem 0 4rem;
    }
    
    .chatbot-header {
      text-align: center;
      margin-bottom: 2.5rem;
    }
    
    .chatbot-header h1 {
      margin-bottom: 1rem;
    }
    
    .chatbot-header p {
      max-width: 800px;
      margin: 0 auto;
      color: var(--text-light);
    }
    
    .chatbot-wrapper {
      display: flex;
      max-width: 1000px;
      margin: 0 auto 3rem;
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-md);
      overflow: hidden;
      min-height: 600px;
    }
    
    .chat-sidebar {
      width: 280px;
      background-color: #f9f9f9;
      border-right: 1px solid #eee;
      display: flex;
      flex-direction: column;
    }
    
    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid #eee;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .sidebar-header h3 {
      color: var(--accent);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .status-indicator {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: #ccc;
    }
    
    .status-indicator.online {
      background-color: #4CAF50;
    }
    
    .quick-actions {
      padding: 1.5rem;
      border-bottom: 1px solid #eee;
    }
    
    .quick-actions h4 {
      color: var(--text);
      margin-bottom: 1rem;
      font-size: 1rem;
    }
    
    .quick-buttons {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .quick-buttons button {
      background-color: white;
      border: 1px solid #eee;
      border-radius: var(--border-radius-sm);
      padding: 0.6rem 1rem;
      text-align: left;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }
    
    .quick-buttons button i {
      color: var(--primary);
    }
    
    .quick-buttons button:hover {
      background-color: var(--primary-light);
      border-color: var(--primary-light);
    }
    
    .conversation-stats {
      padding: 1.5rem;
      margin-top: auto;
      border-top: 1px solid #eee;
    }
    
    .conversation-stats .stat-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
    }
    
    .conversation-stats .stat-label {
      color: var(--text-light);
      font-size: 0.9rem;
    }
    
    .conversation-stats .stat-value {
      font-weight: 600;
      color: var(--accent);
    }
    
    .chat-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
    }
    
    .chat-box {
      flex: 1;
      padding: 1.5rem;
      overflow-y: auto;
      background-color: #f9f9f9;
    }
    
    .chat-date {
      text-align: center;
      margin: 1rem 0;
      font-size: 0.8rem;
      color: var(--text-light);
      position: relative;
    }
    
    .chat-date::before,
    .chat-date::after {
      content: '';
      position: absolute;
      top: 50%;
      width: 70px;
      height: 1px;
      background-color: #eee;
    }
    
    .chat-date::before {
      left: calc(50% - 100px);
    }
    
    .chat-date::after {
      right: calc(50% - 100px);
    }
    
    .chat-message {
      display: flex;
      margin-bottom: 1.5rem;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s, transform 0.3s;
    }
    
    .chat-message.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    .chat-message.user {
      flex-direction: row-reverse;
    }
    
    .message-avatar {
      width: 36px;
      height: 36px;
      min-width: 36px;
      background-color: var(--primary);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 0.8rem;
    }
    
    .chat-message.user .message-avatar {
      background-color: var(--secondary);
      margin-right: 0;
      margin-left: 0.8rem;
    }
    
    .message-content {
      background-color: white;
      padding: 1rem;
      border-radius: 0.75rem 0.75rem 0.75rem 0;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      max-width: 70%;
    }
    
    .chat-message.user .message-content {
      background-color: var(--primary);
      color: white;
      border-radius: 0.75rem 0.75rem 0 0.75rem;
    }
    
    .message-content p {
      margin: 0;
      line-height: 1.5;
    }
    
    .message-content ul {
      margin: 0.5rem 0 0;
      padding-left: 1.5rem;
    }
    
    .message-content a {
      color: var(--primary);
      text-decoration: none;
    }
    
    .chat-message.user .message-content a {
      color: white;
      text-decoration: underline;
    }
    
    .message-time {
      font-size: 0.75rem;
      color: var(--text-light);
      margin-top: 0.25rem;
      padding: 0 0.5rem;
    }
    
    .typing-indicator {
      margin-bottom: 0;
    }
    
    .typing-dots {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      height: 1.5rem;
    }
    
    .typing-dots span {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: var(--text-light);
      opacity: 0.5;
      animation: typingAnimation 1s infinite;
    }
    
    .typing-dots span:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .typing-dots span:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    @keyframes typingAnimation {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-5px);
      }
    }
    
    .chat-input-container {
      display: flex;
      align-items: center;
      padding: 1rem;
      border-top: 1px solid #eee;
      position: relative;
    }
    
    .input-wrapper {
      flex: 1;
      position: relative;
    }
    
    .chat-input-container input {
      width: 100%;
      padding: 0.8rem 3rem 0.8rem 1rem;
      border: 1px solid #eee;
      border-radius: 50px;
      outline: none;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    
    .chat-input-container input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255, 126, 145, 0.1);
    }
    
    .emoji-btn {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--text-light);
      cursor: pointer;
      font-size: 1.1rem;
      transition: color 0.3s;
    }
    
    .emoji-btn:hover {
      color: var(--accent);
    }
    
    .send-btn {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 1rem;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    
    .send-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 3px 8px rgba(244, 107, 142, 0.3);
    }
    
    .emoji-picker {
      position: absolute;
      bottom: 80px;
      right: 20px;
      width: 300px;
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
      padding: 1rem;
      display: none;
      z-index: 10;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s, transform 0.3s;
    }
    
    .emoji-picker.show {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    
    .emoji-categories {
      display: flex;
      border-bottom: 1px solid #eee;
      padding-bottom: 0.5rem;
      margin-bottom: 0.5rem;
    }
    
    .category-btn {
      background: none;
      border: none;
      padding: 0.5rem;
      cursor: pointer;
      transition: transform 0.3s;
      font-size: 1.25rem;
      opacity: 0.5;
    }
    
    .category-btn.active,
    .category-btn:hover {
      opacity: 1;
      transform: scale(1.2);
    }
    
    .emoji-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 0.5rem;
      max-height: 250px;
      overflow-y: auto;
    }
    
    .emoji-grid button {
      font-size: 1.5rem;
      background: none;
      border: none;
      padding: 0.5rem;
      cursor: pointer;
      transition: transform 0.3s;
      border-radius: var(--border-radius-sm);
    }
    
    .emoji-grid button:hover {
      background-color: #f9f9f9;
      transform: scale(1.2);
    }
    
    .chatbot-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin-bottom: 3rem;
    }
    
    .feature-card {
      background-color: white;
      border-radius: var(--border-radius);
      padding: 2rem;
      text-align: center;
      box-shadow: var(--shadow-md);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }
    
    .feature-icon {
      width: 70px;
      height: 70px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      margin: 0 auto 1.5rem;
      font-size: 1.5rem;
    }
    
    .feature-card h3 {
      margin-bottom: 1rem;
      color: var(--accent);
    }
    
    .feature-card p {
      color: var(--text-light);
    }
    
    .chat-topics {
      margin-bottom: 3rem;
    }
    
    .chat-topics h2 {
      text-align: center;
      margin-bottom: 2rem;
      color: var(--accent);
    }
    
    .topics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }
    
    .topic-card {
      background-color: white;
      border-radius: var(--border-radius);
      padding: 1.5rem;
      box-shadow: var(--shadow-md);
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .topic-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }
    
    .topic-icon {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      margin-bottom: 1rem;
      font-size: 1.25rem;
    }
    
    .topic-card h3 {
      margin-bottom: 0.5rem;
      color: var(--accent);
      text-align: center;
    }
    
    .topic-card p {
      color: var(--text-light);
      font-size: 0.9rem;
      text-align: center;
    }
    
    .connection-alert {
      position: fixed;
      bottom: -100px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #f8d7da;
      color: #721c24;
      border-radius: var(--border-radius);
      padding: 1rem;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      gap: 1rem;
      z-index: 1000;
      transition: bottom 0.5s;
      width: 400px;
      max-width: 90%;
    }
    
    .connection-alert.show {
      bottom: 20px;
    }
    
    .alert-icon {
      color: #721c24;
      font-size: 1.5rem;
    }
    
    .alert-content {
      flex: 1;
    }
    
    .alert-content p {
      margin: 0;
    }
    
    .alert-close {
      background: none;
      border: none;
      color: #721c24;
      cursor: pointer;
      padding: 0.5rem;
      font-size: 1rem;
    }
    
    @media (max-width: 768px) {
      .chatbot-wrapper {
        flex-direction: column;
      }
      
      .chat-sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #eee;
      }
      
      .chat-box {
        max-height: 400px;
      }
      
      .emoji-picker {
        width: 80%;
        left: 50%;
        transform: translateX(-50%) translateY(10px);
      }
      
      .emoji-picker.show {
        transform: translateX(-50%) translateY(0);
      }
      
      .topics-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</body>
</html>